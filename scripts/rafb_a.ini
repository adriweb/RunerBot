[aliases]
n0=/rafb {
n1=  ;;;;;;;;; SWITCHES ;;;;;;;;;;
n2=  ; -u  User key
n3=  ; -n  Name
n4=  ; -f  Format
n5=  ; -p  Privacy
n6=  ; -x  Expiration
n7=  ;;;; REQUIRED PARAMETERS ;;;;
n8=  ;     Developer API Key
n9=  ;     File to upload (in quotation marks)
n10=  ;     Operation to call with result
n11=  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
n12=
n13=  ;echo -s $1-
n14=
n15=  tokenize 32 $1-
n16=  var %switches
n17=  var %userkey
n18=  var %name
n19=  var %format
n20=  var %privacy
n21=  var %expiration
n22=  if -* iswm $1 {
n23=    var %switches $right($1,-1)
n24=    tokenize 32 $2-
n25=  }
n26=  while %switches != $null {
n27=    if $1 == $null {
n28=      echo 2 * /rafb: insufficient parameters
n29=      halt
n30=    }
n31=    var %s $left(%switches,1)
n32=    var %switches $right(%switches,-1)
n33=    if %s == u {
n34=      if $regex($1,/[^0-9A-Fa-f]/) {
n35=        echo 2 * /rafb: invalid user key $1
n36=        halt
n37=      }
n38=      var %userkey $+(api_user_key=,$1,&)
n39=    }
n40=    elseif %s == n {
n41=      var %name $+(api_paste_name=,$encodeurl($1),&)
n42=    }
n43=    elseif %s == f {
n44=      if !$istok(4cs 6502acme 6502kickass 6502tasm abap actionscript actionscript3 ada algol68 apache applescript apt_sources asm asp autoconf autohotkey autoit avisynth awk bascomavr bash basic4gl bibtex blitzbasic bnf boo bf c c_mac cil csharp cpp cpp-qt c_loadrunner caddcl cadlisp cfdg chaiscript clojure klonec klonecpp cmake cobol coffeescript cfm css cuesheet d dcs delphi oxygene diff div dos dot e ecmascript eiffel email epc erlang fsharp falcon fo f1 fortran freebasic freeswitch gambas gml gdb genero genie gettext go groovy gwbasic haskell hicest hq9plus html4strict html5 icon idl ini inno intercal io j java java5 javascript jquery kixtart latex lb lsl2 lisp llvm locobasic logtalk lolcode lotusformulas lotusscript lscript lua m68k magiksf make mapbasic matlab mirc mmix modula2 modula3 68000devpac mpasm mxml mysql newlisp text nsis oberon2 objeck objc ocaml-brief ocaml pf glsl oobas oracle11 oracle8 oz pascal pawn pcre per perl perl6 php php-brief pic16 pike pixelbender plsql postgresql povray powershell powerbuilder proftpd progress prolog properties providex purebasic pycon python q qbasic rsplus rails rebol reg robots rpmspec ruby gnuplot sas scala scheme scilab sdlbasic smalltalk smarty sql systemverilog tsql tcl teraterm thinbasic typoscript unicon uscript vala vbnet verilog vhdl vim visualprolog vb visualfoxpro whitespace whois winbatch xbasic xml xorg_conf xpp yaml z80 zxbasic,$1,32) {
n45=        echo 2 * /rafb: invalid format $1
n46=        halt
n47=      }
n48=      var %format $+(api_paste_format=,$lower($1),&)
n49=    }
n50=    elseif %s == p {
n51=      if !$istok(0 1 2,$1,32) {
n52=        echo 2 * /rafb: invalid privacy boolean $1
n53=        halt
n54=      }
n55=      var %privacy $+(api_paste_private=,$1,&)
n56=    }
n57=    elseif %s == x {
n58=      if !$istok(N 10M 1H 1D 1M,$1,32) {
n59=        echo 2 * /rafb: invalid expiration $1
n60=        halt
n61=      }
n62=      var %expiration $+(api_paste_expire_date=,$upper($1),&)
n63=    }
n64=    else {
n65=      echo 2 * /rafb: invalid switch - $+ %s
n66=      halt
n67=    }
n68=    tokenize 32 $2-
n69=  }
n70=  if $2 == $null {
n71=    echo 2 * /rafb: insufficient parameters
n72=    halt
n73=  }
n74=  if $regex($1,/[^0-9A-Fa-f]/) {
n75=    echo 2 * /rafb: invalid dev key $1
n76=    halt
n77=  }
n78=  var %devkey $+(api_dev_key=,$1,&)
n79=  tokenize 32 $2-
n80=  if !$regex(rafb,$1-,/^("[^"]+")/) {
n81=    echo 2 * /rafb: malformed file path
n82=    halt
n83=  }
n84=  if !$exists($regml(rafb,1)) {
n85=    echo 2 * /rafb: no such file $regml(rafb,1)
n86=    halt
n87=  }
n88=  if $gettok($gettok($1-,2-,$asc(")),1-,32) == $null {
n89=    echo 2 * /rafb: insufficient parameters
n90=    halt
n91=  }
n92=  var %sockname
n93=  while (%sockname == $null) || ($sock(%sockname) != $null) {
n94=    var %sockname $+(rafb.,$rand(1,999999999999))
n95=  }
n96=  sockopen %sockname rafb.me 80
n97=  sockmark %sockname $+(key=1&text=) $1-
n98=}
n99=/rafb.return {
n100=  ;echo -s . $1-
n101=  .timer $+ $1 off
n102=  $sock($1).mark $2-
n103=  sockclose $1
n104=}
n105=/encodeurl {
n106=  return $regsubex($1-,/([ !"#$%&'()*,/:;<=>?@[\]^`{|}~ $+ ¡¢£¤¥¦§¨©ª«¬­®¯°±²³´µ¶·¸¹º»¼½¾¿ÀÁÂÃÄÅÆÇÈÉÊËÌÍÎÏÐÑÒÓÔÕÖ×ØÙÚÛÜÝÞßàáâãäåæçèéêëìíîïðñòóôõö÷øùúûüýþÿ])/g,% $+ $base($asc(\1),10,16))
n107=}
