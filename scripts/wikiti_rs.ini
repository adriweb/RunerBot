[script]
n0=on *:sockopen:wikiti*: {
n1=  ;echo -s sockopen $sockname
n2=  ;echo -s sockmark $sock($sockname).mark
n3=  sockwrite -n $sockname GET $gettok($sock($sockname).mark,1,32) HTTP/1.1
n4=  sockwrite -n $sockname Host: wikiti.brandonw.net
n5=  sockwrite $sockname $crlf
n6=}
n7=on *:sockread:wikiti*: {
n8=  var %r
n9=  sockread %r
n10=  ;echo -s sockread $sockname %r
n11=  var %address $gettok($sock($sockname).mark,1,32)
n12=  var %get $gettok($sock($sockname).mark,2,32)
n13=  var %action $gettok($sock($sockname).mark,4-,32)
n14=  if 0 {
n15=    if *<meta name="robots"* iswm %r {
n16=      :close
n17=      sockclose $sockname
n18=      %action
n19=      halt
n20=    }
n21=    if !%get {
n22=      if *<link* iswm %r {
n23=        goto close
n24=      }
n25=      if *<meta name="keywords"* iswm %r {
n26=        :pagefound
n27=        sockclose $sockname
n28=        %action http://wikiti.brandonw.net $+ %address
n29=      }
n30=    }
n31=    else {
n32=      var %getregex $replace($gettok($sock($sockname).mark,3,32),$chr(160),$chr(32))
n33=      if *</html>* iswm %r {
n34=        goto pagefound
n35=      }
n36=      if $regex(%r,%getregex) {
n37=        sockclose $sockname
n38=        %action $regml(1) http://wikiti.brandonw.net $+ %address
n39=      }
n40=    }
n41=  }
n42=  sockclose $sockname
n43=  %action $iif(200 isin %r,http://wikiti.brandonw.net $+ %address)
n44=}
